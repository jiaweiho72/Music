import { useEffect } from 'react';
import { Easing, runOnJS, useAnimatedProps, useDerivedValue, useSharedValue, withDelay, withTiming } from 'react-native-reanimated';
import useCircleValues from './useCircleValues';
export default function useAnimatedValue(_ref) {
  let {
    initialValue = 0,
    radius = 60,
    maxValue = 100,
    clockwise,
    delay = 0,
    value,
    duration,
    onAnimationComplete = () => null,
    activeStrokeWidth = 10,
    inActiveStrokeWidth = 10,
    progressFormatter = v => {
      'worklet';

      return Math.round(v);
    }
  } = _ref;
  const animatedValue = useSharedValue(initialValue);
  const {
    circleCircumference
  } = useCircleValues({
    radius,
    activeStrokeWidth,
    inActiveStrokeWidth
  });
  const animatedCircleProps = useAnimatedProps(() => {
    let biggestValue = Math.max(initialValue, maxValue);
    biggestValue = biggestValue <= 0 ? 1 : biggestValue;
    const maxPercentage = clockwise ? 100 * animatedValue.value / biggestValue : 100 * -animatedValue.value / biggestValue;
    return {
      strokeDashoffset: circleCircumference - circleCircumference * maxPercentage / 100
    };
  });
  useEffect(() => {
    animatedValue.value = withDelay(delay, withTiming(value, {
      duration,
      easing: Easing.linear
    }, isFinished => {
      if (isFinished) {
        var _runOnJS;

        (_runOnJS = runOnJS(onAnimationComplete)) === null || _runOnJS === void 0 ? void 0 : _runOnJS();
      }
    }));
  }, [value]);
  const progressValue = useDerivedValue(() => {
    return `${progressFormatter(animatedValue.value)}`;
  });
  const animatedTextProps = useAnimatedProps(() => {
    return {
      text: progressValue.value
    };
  });
  return {
    animatedCircleProps,
    animatedTextProps,
    progressValue
  };
}
//# sourceMappingURL=useAnimatedValue.js.map